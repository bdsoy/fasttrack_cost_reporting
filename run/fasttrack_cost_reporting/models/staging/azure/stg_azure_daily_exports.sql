begin;
    
        
        
        delete from fasttrack_cost_reporting_dev.transform_cost_reporting.stg_azure_daily_exports
        where (unique_key) in (
            select distinct unique_key
            from fasttrack_cost_reporting_dev.transform_cost_reporting.stg_azure_daily_exports__dbt_tmp
        );

    

    insert into fasttrack_cost_reporting_dev.transform_cost_reporting.stg_azure_daily_exports ("BILLING_ACCOUNT_NAME", "PARTNER_NAME", "RESELLER_NAME", "RESELLER_MPN_ID", "CUSTOMER_TENANT_ID", "CUSTOMER_NAME", "COST_CENTER", "BILLING_PERIOD_END_DATE", "BILLING_PERIOD_START_DATE", "SERVICE_PERIOD_END_DATE", "SERVICE_PERIOD_START_DATE", "BILLING_DATE", "SERVICE_FAMILY", "PRODUCT_ORDER_ID", "PRODUCT_ORDER_NAME", "CONSUMED_SERVICE", "METER_ID", "METER_NAME", "METER_CATEGORY", "METER_SUBCATEGORY", "METER_REGION", "PRODUCT_ID", "PRODUCT_NAME", "SUBSCRIPTION_ID", "SUBSCRIPTION_NAME", "PUBLISHER_TYPE", "PUBLISHER_ID", "PUBLISHER_NAME", "RESOURCE_GROUP_NAME", "RESOURCE_ID", "RESOURCE_LOCATION", "LOCATION", "EFFECTIVE_PRICE", "QUANTITY", "UNIT_OF_MEASURE", "CHARGE_TYPE", "BILLING_CURRENCY", "PRICING_CURRENCY", "COST_IN_BILLING_CURRENCY", "COST_IN_USD", "EXCHANGE_RATE_PRICING_TO_BILLING", "EXCHANGE_RATE_DATE", "SERVICE_INFO_1", "SERVICE_INFO_2", "ADDITIONAL_INFO", "TAGS", "PAYG_PRICE", "FREQUENCY", "TERM", "RESERVATION_ID", "RESERVATION_NAME", "PRICING_MODEL", "UNIT_PRICE", "BENEFIT_ID", "BENEFIT_NAME", "PROVIDER", "SUBSCRIPTION", "PATH", "INGESTED_DATE", "INGESTED_AT", "BATCH_TIMESTAMP", "UNIQUE_KEY", "DBT_LOADED_AT")
    (
        select "BILLING_ACCOUNT_NAME", "PARTNER_NAME", "RESELLER_NAME", "RESELLER_MPN_ID", "CUSTOMER_TENANT_ID", "CUSTOMER_NAME", "COST_CENTER", "BILLING_PERIOD_END_DATE", "BILLING_PERIOD_START_DATE", "SERVICE_PERIOD_END_DATE", "SERVICE_PERIOD_START_DATE", "BILLING_DATE", "SERVICE_FAMILY", "PRODUCT_ORDER_ID", "PRODUCT_ORDER_NAME", "CONSUMED_SERVICE", "METER_ID", "METER_NAME", "METER_CATEGORY", "METER_SUBCATEGORY", "METER_REGION", "PRODUCT_ID", "PRODUCT_NAME", "SUBSCRIPTION_ID", "SUBSCRIPTION_NAME", "PUBLISHER_TYPE", "PUBLISHER_ID", "PUBLISHER_NAME", "RESOURCE_GROUP_NAME", "RESOURCE_ID", "RESOURCE_LOCATION", "LOCATION", "EFFECTIVE_PRICE", "QUANTITY", "UNIT_OF_MEASURE", "CHARGE_TYPE", "BILLING_CURRENCY", "PRICING_CURRENCY", "COST_IN_BILLING_CURRENCY", "COST_IN_USD", "EXCHANGE_RATE_PRICING_TO_BILLING", "EXCHANGE_RATE_DATE", "SERVICE_INFO_1", "SERVICE_INFO_2", "ADDITIONAL_INFO", "TAGS", "PAYG_PRICE", "FREQUENCY", "TERM", "RESERVATION_ID", "RESERVATION_NAME", "PRICING_MODEL", "UNIT_PRICE", "BENEFIT_ID", "BENEFIT_NAME", "PROVIDER", "SUBSCRIPTION", "PATH", "INGESTED_DATE", "INGESTED_AT", "BATCH_TIMESTAMP", "UNIQUE_KEY", "DBT_LOADED_AT"
        from fasttrack_cost_reporting_dev.transform_cost_reporting.stg_azure_daily_exports__dbt_tmp
    );
    commit;